(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5834"],{4650:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("d2-container",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[a("template",{slot:"header"},[a("div",[e._v("文章列表")]),a("div",{staticClass:"tools"},[a("el-select",{staticStyle:{width:"240px"},attrs:{placeholder:"请选择要筛选的文章分类"},on:{change:e.onFilterChange},model:{value:e.filter.categoryId,callback:function(t){e.$set(e.filter,"categoryId",t)},expression:"filter.categoryId"}},[a("el-option",{attrs:{label:"全部",value:"0"}}),e._l(e.categoryList,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})})],2),a("el-input",{staticClass:"input-with-select",staticStyle:{"margin-left":"15px",width:"400px"},attrs:{placeholder:"搜索标题"},model:{value:e.filter.keyword,callback:function(t){e.$set(e.filter,"keyword",t)},expression:"filter.keyword"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(t){e.onFilterChange()}},slot:"append"})],1)],1)]),a("el-dialog",{attrs:{title:"快速修改文章",visible:e.articleDialog.isShow,width:"600px","before-close":e.articleDialogHandleClose},on:{"update:visible":function(t){e.$set(e.articleDialog,"isShow",t)}}},[a("div",{staticClass:"pop-body"},[a("el-form",{staticClass:"articleDialog-form",attrs:{model:e.articleDialog.data,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"置顶方式"}},[a("el-select",{attrs:{placeholder:"请选择置顶方式"},model:{value:e.articleDialog.data.topType,callback:function(t){e.$set(e.articleDialog.data,"topType",t)},expression:"articleDialog.data.topType"}},e._l(e.topTypeOptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})}))],1),a("el-form-item",{attrs:{label:"文章分类"}},[a("el-select",{attrs:{placeholder:"请选择文章分类"},model:{value:e.articleDialog.data.categoryId,callback:function(t){e.$set(e.articleDialog.data,"categoryId",t)},expression:"articleDialog.data.categoryId"}},e._l(e.categoryList,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})}))],1),a("el-form-item",{attrs:{label:"文章标题",prop:"title"}},[a("el-input",{model:{value:e.articleDialog.data.title,callback:function(t){e.$set(e.articleDialog.data,"title",t)},expression:"articleDialog.data.title"}})],1),a("el-form-item",{attrs:{label:"修改时间",prop:"updateTime"}},[a("el-input",{model:{value:e.articleDialog.data.updateTime,callback:function(t){e.$set(e.articleDialog.data,"updateTime",t)},expression:"articleDialog.data.updateTime"}})],1),a("el-form-item",{attrs:{label:"发布时间",prop:"createTime"}},[a("el-input",{model:{value:e.articleDialog.data.createTime,callback:function(t){e.$set(e.articleDialog.data,"createTime",t)},expression:"articleDialog.data.createTime"}})],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.articleDialogHandleClose}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.articleDialogHandleCertain()}}},[e._v("确 定")])],1)]),a("div",{staticClass:"list-warp"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.list}},[a("el-table-column",{attrs:{prop:"serialNumber",label:"文章序号",width:"80"}}),a("el-table-column",{attrs:{prop:"_title",label:"文章标题"}}),a("el-table-column",{attrs:{prop:"categoryName",label:"文章分类",width:"100"}}),a("el-table-column",{attrs:{prop:"authorNickname",label:"发布者昵称",width:"100"}}),a("el-table-column",{attrs:{prop:"typeName",label:"文章类型",width:"80"}}),a("el-table-column",{attrs:{prop:"visNumber",label:"浏览数量",width:"80"}}),a("el-table-column",{attrs:{prop:"_updateTime",label:"修改时间",width:"150"}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.viewWeb(t.row)}}},[e._v("查看")]),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.changeArticle(t.row)}}},[e._v("快速编辑")]),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.toEdit(t.row)}}},[e._v("编辑")]),a("el-button",{staticStyle:{color:"red"},attrs:{type:"text",size:"small"},on:{click:function(a){e.deleteArticle(t)}}},[e._v("删除")])]}}])})],1),a("div",{staticClass:"pagination-warp"},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next","current-page":e.page.pageNumber,"page-size":e.page.pageSize,total:e.page.totalCount},on:{"current-change":e.onPageChange}})],1)],1),a("template",{slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.newArticle()}}},[e._v("新增文章")])],1)],2)},r=[],n=a("6bde"),o=(a("7f7f"),a("ac6a"),a("96cf"),a("3040")),l=a("0c6d"),c=a("c1df"),s=a.n(c),u=a("8ded"),p=a.n(u),d={name:"articleList",data:function(){return{loading:!0,moment:s.a,topTypeOptions:[{id:0,name:"无置顶"},{id:1,name:"主要置顶"},{id:2,name:"次要置顶"}],articleDialog:{isShow:!1,data:{}},list:[],categoryList:[],page:{pageSize:10,pageNumber:1,totalCount:100},filter:{categoryId:"0",keyword:""}}},mounted:function(){var e=this;this.getCategory(function(){e.getData()})},methods:{newArticle:function(){p.a.set("draft-article",null),this.$router.push({name:"article-edit"})},changeArticle:function(e){var t={id:e._id,categoryId:e.categoryId._id,title:e.title,updateTime:e.updateTime,createTime:e.createTime,topType:e.topType};this.articleDialog.data=t,this.articleDialog.isShow=!0},deleteArticle:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var a=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:console.log(t),this.$confirm("此操作将永久删除该文章, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(o["a"])(regeneratorRuntime.mark(function e(){var i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,l["b"].post("/api/article/delete",{id:t.row._id});case 2:i=e.sent,0===i.data.code?(a.$message({type:"success",message:"删除成功!"}),a.list.splice(t.$index,1)):a.$message.error(i.data.msg);case 4:case"end":return e.stop()}},e,this)}))).catch(function(){a.$message({type:"info",message:"已取消删除"})});case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),getCategory:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var a,i,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,l["b"].get("/api/category/list");case 2:a=e.sent,i=[],r=a.data.data,r.forEach(function(e){i.push({id:e._id,name:e.name})}),this.categoryList=i,"function"===typeof t&&t();case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),getData:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var a,i,r,n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,a="/api/article/list",a+=t?"?categoryId=".concat(t.categoryId,"&keyword=").concat(encodeURIComponent(t.keyword),"&pageSize=").concat(this.page.pageSize,"&pageNumber=").concat(this.page.pageNumber-1):"?pageSize=".concat(this.page.pageSize,"&pageNumber=").concat(this.page.pageNumber-1),e.next=5,l["b"].get(a);case 5:i=e.sent,this.page.totalCount=i.data.data.total,r=i.data.data.list,r.forEach(function(e){e.topTypeName=n.getTopName(e.topType),e._title="[".concat(e.topTypeName,"]")+e.title,e.typeName=1===e.type?"单封面":"多封面",e.authorNickname=e.userId.nickname,e.categoryName=e.categoryId.name,e._createTime=s()(e.createTime).format("YYYY-MM-DD HH:mm"),e._updateTime=s()(e.updateTime).format("YYYY-MM-DD HH:mm")}),this.list=r,this.loaded();case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),saveData:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,l["b"].post("/api/config",this.configObj);case 2:t=e.sent,0===t.data.code&&this.$message({message:"保存成功",type:"success"});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),articleDialogHandleClose:function(){var e=this;this.$confirm("确认关闭？").then(function(t){e.articleDialog.isShow=!1}).catch(function(e){})},articleDialogHandleCertain:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,l["b"].post("/api/article/update",this.articleDialog.data);case 2:t=e.sent,a=t.data.msg,1===t.data.code?"object"===Object(n["a"])(a)?this.$message.error(JSON.stringify(a)):this.$message.error(a):(this.$message.success(a),this.articleDialog.data={},this.articleDialog.isShow=!1,this.getData());case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),viewWeb:function(e){window.open(l["a"]+e.serialNumber+".html")},toEdit:function(e){p.a.set("draft-article",null),this.$router.push({name:"article-edit",query:{id:e._id}})},onFilterChange:function(){this.list=[],this.page={pageSize:10,pageNumber:1,totalCount:100},this.getData(this.filter)},getTopName:function(e){var t="无置顶";return this.topTypeOptions.forEach(function(a){a.id===e&&(t=a.name)}),t},onPageChange:function(e){this.page.pageNumber=e,this.getData(this.filter)},loaded:function(){var e=this;setTimeout(function(){e.loading=!1},1e3)}}},g=d,m=(a("a65d"),a("2877")),h=Object(m["a"])(g,i,r,!1,null,"77708132",null);h.options.__file="list.vue";t["default"]=h.exports},a65d:function(e,t,a){"use strict";var i=a("be6e"),r=a.n(i);r.a},be6e:function(e,t,a){}}]);
//# sourceMappingURL=chunk-5834.3e24a933.js.map