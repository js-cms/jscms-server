(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5700"],{"23ee":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("d2-container",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[a("template",{slot:"header"},[t._v("评论列表")]),a("el-dialog",{attrs:{title:(1===t.commentDialog.type?"新建":"修改")+"评论",visible:t.commentDialog.isShow,width:"600px"},on:{"update:visible":function(e){t.$set(t.commentDialog,"isShow",e)}}},[a("div",{staticClass:"pop-body"},[a("el-form",{staticClass:"commentDialog-form",attrs:{model:t.commentDialog.data,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"作者昵称",prop:"authorNickname"}},[a("el-input",{model:{value:t.commentDialog.data.authorNickname,callback:function(e){t.$set(t.commentDialog.data,"authorNickname",e)},expression:"commentDialog.data.authorNickname"}})],1),a("el-form-item",{attrs:{label:"作者url",prop:"authorUrl"}},[a("el-input",{model:{value:t.commentDialog.data.authorUrl,callback:function(e){t.$set(t.commentDialog.data,"authorUrl",e)},expression:"commentDialog.data.authorUrl"}})],1),a("el-form-item",{attrs:{label:"作者email",prop:"authorEmail"}},[a("el-input",{model:{value:t.commentDialog.data.authorEmail,callback:function(e){t.$set(t.commentDialog.data,"authorEmail",e)},expression:"commentDialog.data.authorEmail"}})],1),a("el-form-item",{attrs:{label:"评论内容",prop:"mdContent"}},[a("el-input",{attrs:{type:"textarea",rows:4},model:{value:t.commentDialog.data.mdContent,callback:function(e){t.$set(t.commentDialog.data,"mdContent",e)},expression:"commentDialog.data.mdContent"}})],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.commentDialog.isShow=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.commentDialogHandleCertain()}}},[t._v("确 定")])],1)]),a("div",{staticClass:"list-warp"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.list}},[a("el-table-column",{attrs:{prop:"_articleTitle",label:"所属文章标题",width:"180"}}),a("el-table-column",{attrs:{prop:"_authorNickname",label:"作者昵称",width:"180"}}),a("el-table-column",{attrs:{prop:"_authorUrl",label:"作者url"}}),a("el-table-column",{attrs:{prop:"_authorEmail",label:"作者email"}}),a("el-table-column",{attrs:{prop:"mdContent",label:"内容"}}),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间"}}),a("el-table-column",{attrs:{prop:"updateTime",label:"创建时间"}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.viewWeb(e.row)}}},[t._v("查看")]),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.changeComment(e.row)}}},[t._v("编辑")]),a("el-button",{staticStyle:{color:"red"},attrs:{type:"text",size:"small"},on:{click:function(a){t.deleteComment(e)}}},[t._v("删除")])]}}])})],1),a("div",{staticClass:"pagination-warp"},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next","current-page":t.page.pageNumber,"page-size":t.page.pageSize,total:t.page.totalCount},on:{"current-change":t.onPageChange}})],1)],1)],2)},n=[],i=a("6bde"),r=(a("ac6a"),a("96cf"),a("3040")),l=a("0c6d"),c=a("c1df"),s=a.n(c),m={name:"commentList",data:function(){return{loading:!0,moment:s.a,commentDialog:{type:1,isShow:!1,data:{}},page:{pageSize:10,pageNumber:1,totalCount:100},list:[]}},mounted:function(){this.getData()},methods:{changeComment:function(t){console.log(t),this.commentDialog.data=t,this.commentDialog.type=2,this.commentDialog.isShow=!0},deleteComment:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(e){var a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:this.$confirm("此操作将永久删除该评论, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(r["a"])(regeneratorRuntime.mark(function t(){var o;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,l["b"].post("/api/comment/delete",{id:e.row._id});case 2:o=t.sent,0===o.data.code?(a.$message({type:"success",message:"删除成功!"}),a.list.splice(e.$index,1)):a.$message.error(o.data.msg);case 4:case"end":return t.stop()}},t,this)}))).catch(function(){a.$message({type:"info",message:"已取消删除"})});case 1:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),getData:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,l["b"].get("/api/comment/list?pageSize=".concat(this.page.pageSize,"&pageNumber=").concat(this.page.pageNumber-1));case 2:e=t.sent,a=e.data.data.list,this.page.totalCount=e.data.data.total,a.forEach(function(t){t.articleId?t._articleTitle=t.articleId.title:t._articleTitle="所属文章不存在",t.authorNickname?t._authorNickname=t.authorNickname:t._authorNickname="无",t.authorUrl?t._authorUrl=t.authorUrl:t._authorUrl="无url",t.authorEmail?t._authorEmail=t.authorEmail:t._authorEmail="无email",t.createTime=s()(t.createTime).format("YYYY-MM-DD HH:mm"),t.updateTime=s()(t.updateTime).format("YYYY-MM-DD HH:mm")}),this.list=a,this.loaded();case 8:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),saveData:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,l["b"].post("/api/config",this.configObj);case 2:e=t.sent,0===e.data.code&&this.$message({message:"保存成功",type:"success"});case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),commentDialogHandleCertain:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e,a,o;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(e={},a={authorNickname:this.commentDialog.data.authorNickname,authorUrl:this.commentDialog.data.authorUrl,authorEmail:this.commentDialog.data.authorEmail,mdContent:this.commentDialog.data.mdContent},1!==this.commentDialog.type){t.next=8;break}return t.next=5,l["b"].post("/api/comment/create",a);case 5:e=t.sent,t.next=13;break;case 8:if(2!==this.commentDialog.type){t.next=13;break}return a._id=this.commentDialog.data._id,t.next=12,l["b"].post("/api/comment/update",a);case 12:e=t.sent;case 13:o=e.data.msg,1===e.data.code?"object"===Object(i["a"])(o)?this.$message.error(JSON.stringify(o)):this.$message.error(o):(this.$message.success(o),this.commentDialog.data={},this.commentDialog.isShow=!1,this.getData());case 15:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),onPageChange:function(t){this.page.pageNumber=t,this.getData(this.filter)},viewWeb:function(t){window.open(l["a"]+t.articleId.serialNumber+".html#comment")},loaded:function(){var t=this;setTimeout(function(){t.loading=!1},1e3)}}},u=m,p=(a("4f4a5"),a("2877")),d=Object(p["a"])(u,o,n,!1,null,"547f0294",null);d.options.__file="list.vue";e["default"]=d.exports},"4f4a5":function(t,e,a){"use strict";var o=a("930b"),n=a.n(o);n.a},"6bde":function(t,e,a){"use strict";function o(t){return o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function n(t){return n="function"===typeof Symbol&&"symbol"===o(Symbol.iterator)?function(t){return o(t)}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":o(t)},n(t)}a.d(e,"a",function(){return n})},"930b":function(t,e,a){}}]);
//# sourceMappingURL=chunk-5700.23d1983a.js.map