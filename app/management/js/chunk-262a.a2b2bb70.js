(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-262a"],{"1ab0":function(e,t,a){"use strict";var i=a("841e"),n=a.n(i);n.a},"841e":function(e,t,a){},d378:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("d2-container",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[a("template",{slot:"header"},[e._v("自定义页面列表")]),a("div",{staticClass:"form"},[a("el-dialog",{attrs:{title:(1===e.dialogPage.type?"新建":"修改")+"页面",visible:e.dialogPage.isShow,width:"90%"},on:{"update:visible":function(t){e.$set(e.dialogPage,"isShow",t)}}},[a("div",{staticClass:"pop-body"},[a("el-form",{attrs:{model:e.dialogPage.page,"label-width":"120px"}},[e._l(e.dialogPage.page,function(t,i,n){return[!0===t.formRequired?a("el-form-item",{key:n,attrs:{label:t.name}},["input-text"===t.type?a("el-input",{attrs:{placeholder:t.placeholder},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"field.value"}}):e._e(),"input-textarea"===t.type?a("el-input",{attrs:{type:"textarea",autosize:{minRows:20},placeholder:t.placeholder},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"field.value"}}):e._e()],1):e._e()]})],2)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogPage.isShow=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogPageHandleCertain()}}},[e._v("确 定")])],1)])],1),a("div",{staticClass:"list-warp"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.list}},[e._l(e.tableModel,function(t,i,n){return[!0===t.tableField?a("el-table-column",{key:n,attrs:{prop:i,label:t.name}}):e._e()]}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.viewWeb(t.row)}}},[e._v("查看")]),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.showChangePageDialog(2,t.row)}}},[e._v("编辑")]),a("el-button",{staticStyle:{color:"red"},attrs:{type:"text",size:"small"},on:{click:function(a){e.showDeleteAsking(t.$index,t.row)}}},[e._v("删除")])]}}])})],2)],1),a("div",{staticClass:"pagination-warp"},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next","current-page":e.page.pageNumber,"page-size":e.page.pageSize,total:e.page.totalCount},on:{"current-change":e.onPageChange}})],1),a("template",{slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.showChangePageDialog()}}},[e._v("新增一个页面")])],1)],2)},n=[],s=(a("7f7f"),a("f751"),a("96cf"),a("3040")),o=a("0c6d"),r={getModel:function(e){var t=function(){for(var t in e)if(e.hasOwnProperty(t)){var a=e[t];this[t]=a,this[t].placeholder="请输入"+a.name,this[t].value=a.default||""}this.getValues=function(){var e={};for(var t in this)if(this.hasOwnProperty(t)){var a=this[t];a&&!0===a.formField&&(e[t]=a.value)}return e},this.setValues=function(e){for(var t in this)if(this.hasOwnProperty(t)){var a=this[t];a&&!0===a.formField&&(a.value=e[t])}},this.checkValues=function(){var e=!0;for(var t in this)if(this.hasOwnProperty(t)){var a=this[t];if(a&&!0===a.formField&&!0===a.formRequired&&(void 0===a.value||""===a.value||null===a.value)){e={msg:a.name+"不能为空"};break}}return e}};return t}},l={name:"pageList",data:function(){return{id:"",loading:!0,Page:"",tableModel:{},dialogPage:{type:1,id:"",isShow:!1,page:{}},page:{pageSize:10,pageNumber:1,totalCount:100},list:[]}},mounted:function(){var e=this;this.loadModel("Page",function(){e.getPageList()})},methods:{showChangePageDialog:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0;if(this.dialogPage.type=e,this.dialogPage.isShow=!0,1===e)this.dialogPage.page=new this.Page;else{this.dialogPage.id=t._id;var a=new this.Page;a.setValues(t),this.dialogPage.page=a}},deletePage:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(t,a){var i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,o["b"].post("/api/page/delete",{id:t});case 2:i=e.sent,0===i.data.code?(this.$message({type:"success",message:"删除成功!"}),"function"===typeof a&&a()):this.$message.error(i.data.msg);case 4:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}(),getPageList:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){var t,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,o["b"].get("/api/page/list?pageSize=".concat(this.page.pageSize,"&pageNumber=").concat(this.page.pageNumber-1));case 2:t=e.sent,a=t.data.data.list,this.page.totalCount=t.data.data.total,this.list=a,this.loaded();case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),savePage:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(t,a){var i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,o["b"].post("/api/page/create",t);case 2:i=e.sent,0===i.data.code?(this.$message({message:"保存成功",type:"success"}),this.getPageList(),"function"===typeof a&&a()):this.$message({message:i.data.msg,type:"error"});case 4:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}(),updatePage:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(t,a){var i,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return i=Object.assign(t,{id:this.dialogPage.id}),e.next=3,o["b"].post("/api/page/update",i);case 3:n=e.sent,0===n.data.code?(this.$message({message:"更新成功",type:"success"}),"function"===typeof a&&a()):this.$message({message:n.data.msg,type:"error"});case 5:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}(),loadModel:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(t,a){var i,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,o["b"].get("/api/model?name=".concat(t));case 2:i=e.sent,n=i.data.data.model,this.Page=r.getModel(n),this.tableModel=new this.Page,console.log(this.tableModel),"function"===typeof a&&a();case 8:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}(),dialogPageFormCheck:function(){return""===this.dialogPage.page.name?(this.$message.error("页面名称必填"),!1):""!==this.dialogPage.page.alias||(this.$message.error("页面别名必填"),!1)},dialogPageHandleCertain:function(){var e=this,t=this.dialogPage.page,a=t.checkValues();!0===a?1===this.dialogPage.type?this.savePage(t.getValues(),function(){e.dialogPage.isShow=!1}):this.updatePage(t.getValues(),function(){e.dialogPage.isShow=!1,e.reload()}):this.$message.error(a.msg)},showDeleteAsking:function(e,t){var a=this;this.$confirm("确定要删除该自定义页面？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.deletePage(t._id,function(){a.list.splice(e,1)})})},reload:function(){var e=this;this.list=[],this.loading=!0,setTimeout(function(){e.getPageList()},1e3)},viewWeb:function(e){window.open("".concat(o["a"],"page/").concat(e.alias,".html"))},onPageChange:function(e){this.page.pageNumber=e,this.getData(this.filter)},loaded:function(){var e=this;setTimeout(function(){e.loading=!1},1e3)}}},u=l,c=(a("1ab0"),a("2877")),g=Object(c["a"])(u,i,n,!1,null,"209a3779",null);g.options.__file="list.vue";t["default"]=g.exports}}]);
//# sourceMappingURL=chunk-262a.a2b2bb70.js.map