!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(n=n||self).JscmsSdk=e()}(this,function(){"use strict";var n=[{variable:"",type:"css",version:"latst",url:"https://cdn.jsdelivr.net/npm/heyui/themes/index.css"},{variable:"jQuery",type:"js",version:"3.4.1",url:"https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"},{variable:"Vue",type:"js",version:"latest",url:"https://cdn.jsdelivr.net/npm/vue"},{variable:"HeyUI",type:"js",version:"latest",url:"https://cdn.jsdelivr.net/npm/heyui"},{variable:"less",type:"js",version:"3.9.0",url:"https://cdn.jsdelivr.net/npm/less@3.9.0/dist/less.min.js"}];function e(n){var e=n.url,t=void 0===e?"":e,i=n.callback,o=void 0===i?function(){}:i,r=n.id,a=void 0===r?"":r,s=document.createElement("link"),l="onload"in s,d=536>+navigator.userAgent.replace(/.*(?:AppleWebKit|AndroidWebKit)\/?(\d+).*/i,"$1"),c=3e5;function m(){s.onload=s.onerror=s.onreadystatechange=null,s=null,o()}s.rel="stylesheet",s.type="text/css",s.href=t,void 0!==a&&(s.id=a),document.getElementsByTagName("head")[0].appendChild(s),!d&&l?l?(s.onload=m,s.onerror=function(){m()}):s.onreadystatechange=function(){/loaded|complete/.test(s.readyState)&&m()}:setTimeout(function(){!function n(e,t,i){var o=e.sheet;var r=!1;i+=1;if(i>c)return r=!0,e=null,void t();if(d)o&&(r=!0);else if(o)try{o.cssRules&&(r=!0)}catch(n){"NS_ERROR_DOM_SECURITY_ERR"===n.name&&(r=!0)}setTimeout(function(){r?t():n(e,t,i)},20)}(s,o,0)},1)}function t(n){var e=n.url,t=void 0===e?"":e,i=n.callback,o=void 0===i?function(){}:i,r=n.id,a=void 0===r?"":r,s=n.variable;window[void 0===s?"":s]&&"function"==typeof o&&o();var l=document.getElementsByTagName("head")[0],d=document.createElement("script");d.type="text/javascript",d.src=t,a&&(d.id=a),"function"==typeof o&&(d.onload=d.onreadystatechange=function(){this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||("function"==typeof o&&o(),d.onload=d.onreadystatechange=null)}),l.appendChild(d)}function i(n,e){void 0===n&&(n=""),void 0===e&&(e=function(){})}function o(n,e){void 0===n&&(n=""),void 0===e&&(e="");var t=document.createElement("style");t.type="text/less",e&&(t.id=e);try{t.appendChild(document.createTextNode(n))}catch(e){t.styleSheet.cssText=n}document.getElementsByTagName("head")[0].appendChild(t)}function r(n,e){var t=localStorage.jscms;if(t=t?JSON.parse(t):{},!e)return t[n];t[n]=e,localStorage.jscms=JSON.stringify(t)}var a={template:'<div class="vue-qrcode">  <Modal v-model="opened" className="">    <div style="padding: 10px; text-align: center;">{{title}}</div>    <div class="vue-qrcode-warp" :style="warpStyle">      <div class="item" v-for="(item, index) in images" :key="index">        <div><img class="vue-qrcode-image" v-show="item.url" :src="item.url" :alt="item.desc"></div>        <span v-show="item.desc">{{item.desc}}</span>      </div>    </div>  </Modal></div>',style:"img.vue-qrcode-image {\n  width: 230px;\n  height: 230px;\n}\n\n.vue-qrcode-warp {\n  text-align: center;\n  padding-top: 20px;\n  padding-bottom: 20px;\n  min-width: 350px;\n}\n\n.vue-qrcode-warp .item {\n  display: inline-block;\n}\n",name:"Qrcode",data:function(){return{baseWidth:240,warpStyle:{width:"230px"},title:"扫一扫",images:[],opened:!1}},methods:{show:function(n){this.title=n.title,this.images=n.images,this.warpStyle.width=n.images.length*this.baseWidth+"px",console.log(this.warpStyle),this.opened=!0}}},s={authorization:r("token")};function l(n){window.jQuery.ajax({headers:s,url:n.url,type:n.type,data:n.params,dataType:"json",success:n.callback})}var d=function(n,e){return{then:function(t){void 0===t&&(t=function(){}),l({type:"post",url:n,params:e,callback:t})}}},c=function(n,e){return{then:function(t){void 0===t&&(t=function(){}),l({type:"get",url:n,params:e,callback:t})}}};function m(n){var e=(new Date).getTime();return 600>(e=parseInt((e-n)/1e3))?"刚刚":3600>e&&e>=600?Math.floor(e/60)+"分钟前":86400>e&&e>=3600?Math.floor(e/60/60)+"小时前":259200>e&&e>=86400?Math.floor(e/60/60/24)+"天前":function(n,e){var t=new Date(n),i={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};for(var o in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length))),i)RegExp("("+o+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?i[o]:("00"+i[o]).substr((""+i[o]).length)));return e}(n,"yyyy-MM-dd hh:mm")}var p={template:'<div class="jscms-comment" id="jscmsComment" ref="jscmsComment">  <div class="comment-input-area" ref="commentInpuArea">    <div class="comment-top">      <div class="comment-title">参与评论</div>      <div class="comment-total">共<span class="total-number">{{total}}</span>条</div>    </div>    <div class="comment-middle">      <div class="comment-input-warp">        <textarea v-model="form.mdContent" name="content" id="commentContent" cols="30" rows="10"          :placeholder="config.placeholder"></textarea>      </div>      <div class="comment-control-warp">        <div class="control-login" v-show="config.boolCommentLogin===true">          <a href="javascript:void(0);">登陆 </a>后参与评论        </div>        <div class="control-user" v-show="config.boolCommentLogin===false">          <span class="user-avatar" :style="{\'background-image\': \'url(\'+ config.currentUser.avatar +\')\'}"></span>          <span class="user-nickname">{{config.currentUser.nickname}}</span>        </div>        <div class="control-user-reply" v-show="reply.user.id">          回复：{{reply.user.nickname}}          <i class="reply-close" @click="replyClear"></i>        </div>        <div class="control-submit">          <span class="input-total">{{form.mdContent.length}}/1000</span>          <span class="btn-submit" @click="submit">            提交评论          </span>        </div>      </div>    </div>    <div class="comment-tips">      {{config.tips}}    </div>  </div>  <div class="comment-content-area">    <div class="comment-top">      <div class="comment-title">评论区域</div>    </div>    <div class="comment-list" ref="commentList">      <ul class="comment-list-ul" v-if="commentsList.length">        <li class="comment-list-li" v-for="(item, index) in commentsList" :key="index">          <div class="comment-list-item" :id="\'commentItem_\' + index" :ref="\'commentItem_\' + index">            <div class="item-top">              <div class="item-avatar">                <span :style="{\'background-image\': \'url(\'+ item.userAuthor.avatar +\')\'}"></span>              </div>              <div class="item-info">                <span class="nickname">{{item.userAuthor.nickname}}</span>                <span class="time">· {{item.ftime}}</span>                <span class="id">· {{item.numberId}}楼</span>              </div>              <div class="item-right">                <span class="like-icon" :class="{\'normal\': !item.liked, \'liked\': item.liked}" @click="like(item)"></span>                <span class="like-number">{{item.likeUserIds.length}}</span>                <a class="btn-reply" href="javascript:void(0);" @click="replyHandle(item, 2, index, \'commentItem_\' + index)">回复</a>              </div>            </div>            <div class="comment-content" v-if="!item.shield">              <span class="comment-reply-user-nickname" v-if="item.userReplied && item.userReplied.nickname">回复 · {{item.userReplied.commentNumberId}}楼 · {{item.userReplied.nickname}}</span>              <span v-html="item.htContent"></span>            </div>            <div class="comment-content shield" v-if="item.shield">              该评论内容已被屏蔽            </div>            <div class="comment-children" v-if="item.children.list.length">              <ul class="comment-list-ul">                <li class="comment-list-li" v-for="(subItem, idx) in item.children.list" :key="idx">                  <div class="comment-list-item" :id="\'commentChildItem_\' + index + \'_\' + idx" :ref="\'commentChildItem_\' + index + \'_\' + idx">                    <div class="item-top">                      <div class="item-avatar">                        <span :style="{\'background-image\': \'url(\'+ subItem.userAuthor.avatar +\')\'}"></span>                      </div>                      <div class="item-info">                        <span class="nickname">{{subItem.userAuthor.nickname}}</span>                        <span class="time">· {{subItem.ftime}}</span>                        <span class="id">· {{subItem.numberId}}楼</span>                      </div>                      <div class="item-right">                        <span class="like-icon" :class="{\'normal\': !subItem.liked, \'liked\': subItem.liked}" @click="like(subItem)"></span>                        <span class="like-number">{{subItem.likeUserIds.length}}</span>                        <a class="btn-reply" href="javascript:void(0);" @click="replyHandle(subItem, 3, index, \'commentChildItem_\' + index + \'_\' + idx)">回复</a>                      </div>                    </div>                    <div class="comment-content" v-if="!subItem.shield">                      <span class="comment-reply-user-nickname" v-if="subItem.userReplied && subItem.userReplied.nickname">回复 · {{subItem.userReplied.commentNumberId}}楼 · {{subItem.userReplied.nickname}}</span>                      <span v-html="subItem.htContent"></span>                    </div>                    <div class="comment-content shield" v-if="subItem.shield">                      该评论内容已被屏蔽                    </div>                  </div>                </li>              </ul>              <div class="btn-more-child" v-show="item.children.total > 3 && item.children.list.length === 3">                <a href="javascript:void(0);" @click="loadMoreChild(item)">                  <span v-show="item.children.total===999">加载中...</span>                  <span v-show="item.children.total<999">查看全部{{item.children.total}}条</span>                </a>              </div>            </div>          </div>        </li>      </ul>      <div class="no-comment" v-if="commentsList.length === 0">        期待你的评论。      </div>    </div>    <div class="loading-warp" v-show="loading">      <Loading text="评论加载中..." :loading="loading"></Loading>    </div>    <div class="comment-more" v-show="hasMore">      <span class="btn-more" @click="loadMore">加载更多</button>    </div>  </div></div>',style:'.jscms-comment {\n  @mainColor: #4285f4;\n  @mainDeepColor: #326ac5;\n  @fontColor: #262626;\n  // @mainColor: #45b984;\n  // @mainDeepColor: #398d67;\n  \n  .clear() {\n    content: "";\n    display: block;\n    height: 0;\n    clear: both;\n    visibility: hidden;\n  }\n\n  width: 100%;\n\n  a {\n    text-decoration: none;\n    color: @mainColor;\n\n    &:hover {\n      color: @mainDeepColor;\n    }\n  }\n\n  .comment-title {\n    margin-left: 2px;\n    float: left;\n    padding-top: 5px;\n    padding-bottom: 5px;\n    border-bottom: 2px solid @mainColor;\n    font-size: 16px;\n    font-weight: 400;\n    color: @fontColor;\n  }\n\n  .comment-input-area {\n    width: 100%;\n\n    .comment-top {\n      width: 100%;\n      box-sizing: border-box;\n\n      &::after {\n        .clear()\n      }\n\n      .comment-total {\n        padding-top: 5px;\n        padding-bottom: 5px;\n        float: right;\n        color: #787878;\n      }\n\n    }\n\n    .comment-middle {\n      margin-top: 10px;\n      background: rgba(245, 247, 249, .8);\n      border: 1px solid #ddd;\n      border-radius: 2px;\n\n      .comment-input-warp {\n        textarea {\n          border: 0;\n          color: #333;\n          flex: 1;\n          font-size: 14px;\n          height: 130px;\n          padding: 10px;\n          resize: none;\n          width: 100%;\n\n          &:focus {\n            box-shadow: none;\n          }\n        }\n      }\n\n      .comment-control-warp {\n        height: 50px;\n        line-height: 30px;\n        padding: 10px;\n\n        .control-login {\n          float: left;\n        }\n\n        .control-user {\n          color: @mainColor;\n          float: left;\n          height: 30px;\n          margin-right: 30px;\n          padding-left: 40px;\n          position: relative;\n\n          .user-avatar {  \n            background: no-repeat 50% @mainColor;\n            background-size: cover;\n            border-radius: 50%;\n            height: 30px;\n            left: 0;\n            position: absolute;\n            top: 0;\n            width: 30px;\n          }\n        }\n\n        .control-user-reply {\n          background-color: #e1e9f6;\n          border-radius: 2px;\n          color: #4285f4;\n          float: left;\n          height: 30px;\n          padding: 0 60px 0 10px;\n          position: relative;\n          max-width: 300px;\n          overflow: hidden;\n          text-overflow:ellipsis;\n          white-space: nowrap;\n\n          i.reply-close {\n            background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAAAXNSR0IArs4c6QAAA2hJREFUSA3tVVtIFGEU/s/MbOvOSJQhJNmFLi89VBRlSt52tg2xhwgsQoMgDPIhykBdfRHCXQskiIog6iGiIC0KMmtztTS6YQUFgUS9BFFIdmFn1svunM6/OTHNXh96EdqXc/u+8/3nzD+zjP3/zfYNgH0Ar18vijLsAQZXQq1ys72eTaz69UZEbJAEtjvoU15YOYI14H6MYQFDLEQ0mlR/uMtezxQTp4m4xMMVBoNldnyCYKhVuSkwOMeBiKzR7deO2UmpYrdfP0yc47zOe/T75Ot2bMJKOYDWAZ6Afp7sfh4DQBsdxM/9VD81oDWggWd4nfAXSKyeLNrxCRPOELDUJx+g53iJxyTc4enQj9jJZuzxa/U02Wkec06cm0Tsd91kJbHtiMJQQLvMkO2JlwU4OOBT4us24e5AeB9DuEinIi12tcyn1LUDGGbdbpNOaII4ccFKZS+tpieeQ3Y2LjADUAORWjDgAhfjGI5NJ8ZpSZ/hTL8/pn0QpeEnejetdgeNQaeHWiIaCHiFciKJ3SwtlmvaKyH6h5TCyUqQc2uu4Zzxd/oNZFhNgjONUaID9Oatknd274KpFBp/pbMW5KyqU+icDOsPaYVF8S4Az5y5cnnfIZj8q2uaIO0ztPOimlZOJ1xn5rnPc2acjc16Qm8g4o6icZumc9EaH/HmtN4t9NJFJBC2B32ugX8m6O2MlMViRh8JyCT2VJFk77SLwVRY76dLs5FyuigKVcEW11Am0YwTejv1kmgM79E8udR4BETZ098CP3jj6gDOj6A+SFOvpYsUlkTYFmyRH6cTTSvoPq5vgqhxn75Pc+nqv8oBWe31wTdrwyo/5k8x7QF9aVZTs58oCVsHmuXnVozVTynoPqGtZ9MYIvA8APaGMaUy1ApfrWTT33ZSK5iOsCGadCXlvjMHqANNykuzbrVJBdWOyTWMTQ/SZHkk9nYOUyr6WmHMSrT73i59cXQCh2n1S6npOGOOylCb87UdlyDo6YwsMYzYCF3BfAKP5jhYxZ2m3M92YrLYE5hYjkZsiC7XIvqGjUlOYUPwqPzRik18D42Y+lsM3osSuLMV4037fTkfHJKo0la+8B6xKVZiFeN+gmBhgXIVBLHOCXLx/Wblk52QKb7bnDPqAHEzo3+WxQtdtzLh/9dn3wZ+AQ3jP9VhQ3yRAAAAAElFTkSuQmCC) no-repeat 50%;\n            background-size: 14px;\n            cursor: pointer;\n            height: 30px;\n            position: absolute;\n            right: 0;\n            top: 0;\n            transition: all .5s;\n            width: 30px;\n\n            &:hover {\n              -webkit-transform: rotate(180deg);\n              transform: rotate(180deg);\n            }\n          }\n        }\n\n        .control-submit {\n          float: right;\n\n          .input-total {\n            color: #787878;\n            font-size: 14px;\n            padding-right: 10px;\n            padding-left: 10px;\n          }\n\n          .btn-submit {\n            background-color: @mainColor;\n            border-radius: 1px;\n            color: #fff;\n            cursor: pointer;\n            float: right;\n            height: 30px;\n            padding: 0 12px;\n            position: relative;\n            user-select: none;\n            transition: all 0.3s;\n\n            &:hover {\n              background-color: @mainDeepColor;\n            }\n          }\n\n        }\n      }\n    }\n\n    .comment-tips {\n      font-size: 14px;\n      color: #787878;\n      padding-top: 10px;\n    }\n  }\n\n  .comment-content-area {\n    margin-top: 20px;\n\n    .comment-top {\n      width: 100%;\n      box-sizing: border-box;\n\n      &::after {\n        .clear()\n      }\n    }\n\n    .comment-list {\n      margin-top: 20px;\n\n      .comment-list-ul {\n        .comment-list-li {\n\n          &:last-child {\n            .comment-list-item {\n              border-bottom: none;\n            }\n          }\n\n          .comment-list-item {\n            position: relative;\n            border-bottom: 1px solid #f5f5f5;\n            padding-bottom: 15px;\n            margin-bottom: 15px;\n\n            .item-top {\n              &::after {\n                .clear()\n              }\n\n              .item-avatar {\n                float: left;\n\n                span {\n                  background-color: @mainColor;\n                  background-position: 50%;\n                  background-repeat: no-repeat;\n                  background-size: cover;\n                  border-radius: 50%;\n                  display: block;\n                  height: 40px;\n                  width: 40px;\n                }\n              }\n\n              .item-info {\n                float: left;\n\n                .nickname {\n                  font-size: 14px;\n                  color: @fontColor;\n                  margin-left: 10px;\n                }\n\n                .time {\n                  font-size: 12px;\n                  color: #a7a7a7;\n                }\n                \n                .id {\n                  font-size: 12px;\n                  color: #a7a7a7;\n                }\n              }\n\n              .item-right {\n                float: right;\n\n                .like-icon {\n                  background-size: 100%;\n                  cursor: pointer;\n                  display: inline-block;\n                  height: 24px;\n                  width: 24px;\n                  margin-right: 10px;\n                  vertical-align: text-top;\n                  background-repeat: no-repeat;\n                  position: relative;\n                  top: -4px;\n                  right: -15px;\n\n                  &.normal {\n                    background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAA+tJREFUaAXtWN1LFFEUv3dmNl1NUSKIPi0I8qGehMIkMfxICfuCDdLddT999KU/oNegf8BddtfZsrIQsx5SqCSKCjKqV7NNkkjKMDE/cp17O3d1bBjd2Z39oCFmYblzzz3nnt/vzDn3XAYh82dGwIyAGYH/PgK9vb3lwWi0Mh9EcT42Ve4ZCInnKEVRhOhWkA+Vlxadt9lsi0qdbJ7zSiAYFs8QQu8CQIsMEmM8XFZibQUSy7Ism5HLxljLNhAWT0Pk74AOgMfTGKN+pk8pbZqZW+gbGRkRtOzTXcsLAUibZkRRP4DdgjD+IWCu3ud22oDE7QQwis6OffwswnrW/rPeQB2pQDjaBMAGEuARnuEpavB47O8hdcjBA/vsGOHBVRt6CXSvqO31znNKANKmHlFyD0AUQLR/cgJt8Hqdb2VQdXV1K7t3br+IMJpYk9nktUzHnOQhcx4MR08SSu9D6hTCdBZxQqOvo/2NGtjk1HQX6FQwOUb0pXpd7zwnBCAVagkhD8C5FSI/hznhlM/V/loNpjssOhEhV5kcjr93RQVCl1pH7zzrY7Q7FK2BSA5BzhcDrF+Y45r8bvsLNZBgJNpCJAr5TwWog08W3lrtctmm1Hp651kRCISvV1NChlmTgiKdB/DNPpf9mRpEMHLjGJFWHoO8CN7QdwtnOe5ytX1Q62UyT0kgEOpJFJqALaNud1tMdsKuBiROX8HBXgqyBQDf4nc7nsrr8tgduXkIkfhz0NvGZJjD1+B5Q3rJ+soRc/zXzQKi1ElZA9CM+piBhOOdMATWjSVUuQYe8Tx/weuybwAviuKupXicvaEEeGZLCb28vkeKBypJCHpK0O9x+pOp5uQYlQr4UbWDSGSgbGkFDQHkveo1PXOorQ74J8WZ8g3ocabUXT68Zx7FYjVKmZ5nPLc4CMBroZPHWBNMZps3Ap1VVXFwOpvMsZYc6ms/RehEQgfjsJZu3ghoOU21BoeDF+qLHTBxq4B6tPST5paWUT7XVm+p1M18QOoMOByOb1r+DEdgfGKyFa4aOxhojvJ/T70kLAxHAI7ZxJEJ3Xrc42l7kgT3uthQBCKRWxWArJGhoxwOQgpBLWv/DFXEy2TZl27xyrQM8wb0Fq/hCOgtXsMR0Fu8hiLAiheuDQ0MVLrFaygCieKFYx9Apey8MnB5/OdFnGnxygRycozyv6WqUEjM6OI2Hps8qqfzysDlMScEJEl6KG+of1ztVXLn9XrbdW2REwK6PG6izL5kwM3Nm07nVZunJsALR5gRLt7yRWlstXCP5hGXWFPK9T7zEqGlJYVjufrYq9e/qW9GwIyAGQEzAmYEzAhkE4E/wI1f80wVWGMAAAAASUVORK5CYII=);\n                  }\n\n                  &.liked {\n                    background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAArZJREFUaAXtWE9rE0EUf2+TTXKqtYiioigiUihCEQRBv0CvyWa154IHj9485QP4Bcy1sSZdKl4UpGjNSS0e1PjnIh4KehEFRQvZze7zbWRhLZudWXcrI85CmMn7//vNvBc2APrRDGgGNAOagRwMYA5faVeyrKM+GfOludm72GqNpB0lDA0Jm1wmrmWd9QgHPgV3vMHrDrVaheYsNNhOpFz8GQjgPhFNhToCsL1Xb27stMvzfdcAuPWL80C4zkVPxwtkMEtuo3k9Lsuz3xUAw/ql0wD+Ohe7N6k4ll/1Gs1rSbqsssKbeGjbc+jTBhe5L60YTrxtGjCFjuOn2Yl0hZ4A2fYsjoIHouLHRSHezlt8GKcsQiir51F5yvWDh2y/X+SDCH3z4IElkZ2MvpArRIuLJ1139AiIDomScvEDE+ECs/9VZCujzw2Ar80JZr7PM/KwMCHCVqVcOofd7kehraSBEMCw3myGsSrV8jNcWXkfj8vX5rgbYJ8n/JG4PGnPzH8xS8Z57PXeJun/VCbRA9QLg3ued5mXdjwR/8JekSk+9CHCJ65P9rAx5iMeZuK+ZMBmeXX13kQDVkgASHPPoqMFvmYLWTwCn3Fb1jHul61JfoWO0UlJcsi/Q632Oc1fdQAdXF7+8e8CMH7vuSQgyp4AT63NiuM8Tyo6LlMWAKCY/RDIX5xCcd7S94j4zaxVu+lWv7RqngDRTVHzRuDUBFA2pN/alAMwbt5e70XEsGhVDgC/hkqzH4JTqonHzTszLdW80cmodgIdbLe3o+JkVqUAEJUyXZ8QoDIAuHmfVtduvZRhPW6jDADmMjP7ypwAs//JnNkzfnGKsyuzzzWFEGmNx947mUQTbQwKTNPcyNq8UTwxAAP4XzYAE+BD5BStpuM85n340Y9mQDOgGdAMaAY0A/8lAz8Bc5fA/BF5WqMAAAAASUVORK5CYII=);\n                  }\n                }\n\n                .like-number {\n                  font-size: 13px;\n                  padding-left: 5px;\n                  padding-right: 5px;\n                  margin-right: 2px;\n                  color: #787878;\n                }\n              }\n            }\n\n            .comment-content {\n              line-height: 22px;\n              text-align: justify;\n              word-wrap: break-word;\n              word-break: normal;\n              position: relative;\n              margin-left: 50px;\n              top: -10px;\n              margin-bottom: 10px;\n              color: @fontColor;\n\n              &.shield {\n                color: #bbbbbb;\n              }\n\n              .comment-reply-user-nickname {\n                color: #787878;\n              }\n\n              p {\n                word-wrap: break-word;\n                word-break: normal;\n                margin: 0px;\n                padding: 0px;\n              }\n            }\n\n            .comment-children {\n              position: relative;\n              background-color: #edf1f4;\n              width: calc(~"100% - 50px");\n              margin-left: 50px;\n              padding: 0 15px;\n              box-sizing: border-box;\n\n              &:before {\n                -webkit-transform: rotate(45deg);\n                background-color: #edf1f4;\n                content: " ";\n                display: block;\n                height: 40px;\n                left: 14px;\n                position: absolute;\n                top: 0;\n                transform: rotate(45deg);\n                width: 40px;\n              }\n\n              .comment-list-ul {\n\n                .comment-list-li {\n\n                  &:last-child {\n                    .comment-list-item {\n                      border-bottom: none;\n                    }\n                  }\n\n                  .comment-list-item {\n                    padding: 14px 0 16px;\n                    position: relative;\n                    margin-bottom: 0px;\n                    border-bottom: 1px dotted #cecdcd;\n\n                    .item-top {\n                      margin-top: 10px;\n\n                      .item-avatar {\n                        span {\n                          background-color: @mainColor;\n                          background-position: 50%;\n                          background-repeat: no-repeat;\n                          background-size: cover;\n                          border-radius: 50%;\n                          display: block;\n                          height: 30px;\n                          width: 30px;\n                        }\n                      }\n\n                      .item-info {\n                        .time {\n                          color: #888888;\n                        }\n                      }\n                    }\n\n                    .comment-content {\n                      top: -3px;\n                      font-size: 13px;\n                      margin-left: 40px;\n                      margin-bottom: 0px;\n                    }\n                  }\n                }\n              }\n\n              .btn-more-child {\n                padding: 10px;\n                text-align: center;\n                font-size: 14px;\n                background-color: transparent;\n              }\n            }\n          }\n        }\n      }\n\n      .no-comment {\n        color: #787878;\n        padding: 30px;\n        text-align: center;\n      }\n    }\n\n    .comment-more {\n      padding: 10px;\n      padding-top: 0px;\n      text-align: center;\n\n      .btn-more {\n        display: inline-block;\n        border-radius: 20px;\n        width:  100px;\n        height: 30px;\n        line-height: 29px;\n        border: 1px solid @mainColor;\n        color: @mainColor;\n        font-size: 14px;\n        transition: all 0.2s;\n        cursor: pointer;\n\n        &:hover {\n          background-color: @mainColor;\n          color: #fff;\n        }\n      }\n    }\n\n    .loading-warp() {\n      min-height: 250px;\n      width: 100%;\n    }\n  }\n}\n',name:"Comment",data:function(){return{theme:{fontColor:"#262626",mainColor:"#4285f4",mainDeepColor:"#326ac5"},article:{id:window.__JSCMS_CONSTANT__.article.id,numberId:window.__JSCMS_CONSTANT__.article.numberId},form:{numberId:window.__JSCMS_CONSTANT__.article.numberId,mdContent:""},config:{currentUser:{}},params:{numberId:window.__JSCMS_CONSTANT__.article.numberId,pageSize:10,pageNumber:1},reply:{parentIndex:0,level:1,user:{},commentId:"",commentNumberId:0,ref:""},commentsList:[],loading:!0,hasMore:!1,needLogin:!0,total:0}},created:function(){o("\n      .h-loading .h-loading-circular>svg .circle {\n        stroke: "+this.theme.mainColor+" !important;\n      }\n    ")},mounted:function(){var n=this;c("http://127.0.0.1:7011/api/front/comment/config").then(function(e){n.config=e.data,n.loadList()})},methods:{dataHandle:function(n){var e=this.config.currentUser._id;n.liked=!1,n.ftime=m(n.createTime),e&&n.likeUserIds.includes(e)&&(n.liked=!0)},loadList:function(){var n=this;this.loading=!0,c("http://127.0.0.1:7011/api/front/comment/list",this.params).then(function(e){setTimeout(function(){if(0===e.code){var t=function(e){return e.forEach(function(e){n.dataHandle(e),e.children&&e.children.list&&e.children.list.forEach(function(e){n.dataHandle(e)})}),e}(e.data.list),i=n.commentsList.length;n.commentsList=i?n.commentsList.concat(t):t,n.total=e.data.total,n.hasMore=n.total>(i=n.commentsList.length),n.loading=!1}else n.$Message({type:"error",text:"数据加载失败"})},500)})},loadMore:function(){this.params.pageNumber++,this.loadList()},loadMoreChild:function(n,e){var t=this;void 0===e&&(e=function(){}),999!==n.children.total&&(n.children.total=999,c("http://127.0.0.1:7011/api/front/comment/childlist",{commentId:n._id,numberId:this.params.numberId,pageNumber:1,pageSize:999}).then(function(i){setTimeout(function(){var o=i.data.list;o.forEach(function(n){return t.dataHandle(n)}),n.children.list=o,n.children.total=i.data.total,t.$nextTick(e)},500)}))},check:function(){if(this.form.mdContent.replace(/[\r\n]/g,"").replace(/\s+/g,"")){if(1e3>=this.form.mdContent.length)return!0;this.$Message({type:"error",text:"评论内容字符长度不能超过1000"})}else this.$Message({type:"error",text:"评论内容不能为空"})},submit:function(){var n=this;if(this.check()){var e=Object.assign(this.form,{repliedUserId:this.reply.user.id,commentId:this.reply.commentId});d("http://127.0.0.1:7011/api/front/comment/create",e).then(function(e){if(0===e.code){var t=e.data;if(t.userAuthor={id:n.config.currentUser._id,nickname:n.config.currentUser.nickname,avatar:n.config.currentUser.avatar},t.children={list:[],total:0},n.dataHandle(t),1===n.reply.level)n.commentsList.unshift(t),n.total++,n.toTop(n.$refs.commentList),n.reset();else if(2===n.reply.level||3===n.reply.level){n.loadMoreChild(n.commentsList[n.reply.parentIndex],function(){var e=n.$refs[n.reply.ref];e&&e.length&&(e=e[0]);var t,i=[];2===n.reply.level?i=e.querySelectorAll(".comment-list-li"):3===n.reply.level&&(i=e.parentNode.parentNode.querySelectorAll(".comment-list-li")),t=i[i.length-1],n.$nextTick(function(){return n.toTop(t)}),n.reset()})}}n.$Message({type:0===e.code?"success":"error",text:e.msg})})}},reset:function(){this.replyClear(),this.form.mdContent=""},replyHandle:function(n,e,t,i){this.toTop(this.$refs.jscmsComment),this.reply.parentIndex=t,this.reply.level=e,this.reply.user=n.userAuthor,this.reply.commentId=n._id,this.reply.commentNumberId=n.numberId,this.reply.ref=i},toTop:function(n){if(n){n.length&&(n=n[0]);var e,t=n.getBoundingClientRect().top+(e=0,document.documentElement&&document.documentElement.scrollTop?e=document.documentElement.scrollTop:document.body&&(e=document.body.scrollTop),e);window.scrollTo(0,t)}},like:function(n){var e={commentId:n._id};!0===n.liked?c("http://127.0.0.1:7011/api/front/comment/unlike",e).then(function(e){0===e.code&&(n.liked=!1,n.likeUserIds=e.data.likeUserIds)}):c("http://127.0.0.1:7011/api/front/comment/like",e).then(function(e){0===e.code&&(n.liked=!0,n.likeUserIds=e.data.likeUserIds)})},replyClear:function(){this.reply.parentIndex=0,this.reply.level=1,this.reply.user={},this.reply.commentId="",this.reply.ref="",this.reply.commentNumberId=0}}};return function(){function s(n){void 0===n&&(n={}),this.loadedCallbacks=[],this.loader={css:e,js:t,vue:i,style:o}}var l=s.prototype;return l._mountApi=function(){var n=this;this.comment={},this.comment.render=function(e){void 0===e&&(e={});var t=document.querySelector(e.selector);t.innerHTML="";var i=n._createDiv("",t);return n._initVue({component:p,selector:"#"+i.id,id:n._id()})},this.dialog={};var e=this._createDiv();this.dialog.qrcode=this._initVue({component:a,selector:"#"+e.id,id:e.id})},l._createDiv=function(n,e){void 0===n&&(n=""),void 0===e&&(e=document.body);var t=document.createElement("div");return t.id=n||this._id(),e.appendChild(t),t},l._id=function(){return"id_"+Math.random().toString(36).substr(2)},l._initVue=function(n){var e=n.component,t=n.selector;o(e.style,"vueStyle_"+n.id);var i=new Vue(Object.assign({el:t},e));return window.less.refresh(),i},l.init=function(o){var r=this;"function"==typeof o&&this.loadedCallbacks.push(o),function(n,o){void 0===o&&(o=function(){});var r="string"==typeof n?[n]:n,a=r.length;r.forEach(function(n){var r=n.variable,s=n.url,l=n.after||function(){},d=function(n,e){};switch(n.type){case"css":d=e;break;case"vue":d=i;break;default:d=t}d({url:s,variable:r,callback:function(){--a>0||(l(),o())}})})}(n,function(){r._mountApi(),r.loadedCallbacks.forEach(function(n){return n.call(r)})})},l.loaded=function(n){"function"==typeof n&&this.loadedCallbacks.push(n)},l.store=function(n,e){return r(n,e)},s}()});
