!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(n=n||self).JscmsSdk=t()}(this,function(){"use strict";var n=[{variable:"",type:"css",version:"latst",url:"https://cdn.jsdelivr.net/npm/heyui/themes/index.css"},{variable:"jQuery",type:"js",version:"3.4.1",url:"https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"},{variable:"Vue",type:"js",version:"latest",url:"https://cdn.jsdelivr.net/npm/vue"},{variable:"HeyUI",type:"js",version:"latest",url:"https://cdn.jsdelivr.net/npm/heyui"},{variable:"less",type:"js",version:"3.9.0",url:"https://cdn.jsdelivr.net/npm/less@3.9.0/dist/less.min.js"}];function t(n){var t=n.url,e=void 0===t?"":t,o=n.callback,i=void 0===o?function(){}:o,a=n.id,r=void 0===a?"":a,s=document.createElement("link"),d="onload"in s,l=536>+navigator.userAgent.replace(/.*(?:AppleWebKit|AndroidWebKit)\/?(\d+).*/i,"$1"),c=3e5;function m(){s.onload=s.onerror=s.onreadystatechange=null,s=null,i()}s.rel="stylesheet",s.type="text/css",s.href=e,void 0!==r&&(s.id=r),document.getElementsByTagName("head")[0].appendChild(s),!l&&d?d?(s.onload=m,s.onerror=function(){m()}):s.onreadystatechange=function(){/loaded|complete/.test(s.readyState)&&m()}:setTimeout(function(){!function n(t,e,o){var i=t.sheet;var a=!1;o+=1;if(o>c)return a=!0,t=null,void e();if(l)i&&(a=!0);else if(i)try{i.cssRules&&(a=!0)}catch(n){"NS_ERROR_DOM_SECURITY_ERR"===n.name&&(a=!0)}setTimeout(function(){a?e():n(t,e,o)},20)}(s,i,0)},1)}function e(n){var t=n.url,e=void 0===t?"":t,o=n.callback,i=void 0===o?function(){}:o,a=n.id,r=void 0===a?"":a,s=n.variable;window[void 0===s?"":s]&&"function"==typeof i&&i();var d=document.getElementsByTagName("head")[0],l=document.createElement("script");l.type="text/javascript",l.src=e,r&&(l.id=r),"function"==typeof i&&(l.onload=l.onreadystatechange=function(){this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||("function"==typeof i&&i(),l.onload=l.onreadystatechange=null)}),d.appendChild(l)}function o(n,t){void 0===n&&(n=""),void 0===t&&(t=function(){})}function i(n,t){void 0===n&&(n=""),void 0===t&&(t="");var e=document.createElement("style");e.type="text/less",t&&(e.id=t);try{e.appendChild(document.createTextNode(n))}catch(t){e.styleSheet.cssText=n}document.getElementsByTagName("head")[0].appendChild(e)}function a(n,t){var e=localStorage.jscms;if(e=e?JSON.parse(e):{},!t)return e[n];e[n]=t,localStorage.jscms=JSON.stringify(e)}var r={template:'<div class="vue-qrcode">  <Modal v-model="opened" className="">    <div style="padding: 10px; text-align: center;">{{title}}</div>    <div class="vue-qrcode-warp" :style="warpStyle">      <div class="item" v-for="(item, index) in images" :key="index">        <div><img class="vue-qrcode-image" v-show="item.url" :src="item.url" :alt="item.desc"></div>        <span v-show="item.desc">{{item.desc}}</span>      </div>    </div>  </Modal></div>',style:"img.vue-qrcode-image {\n  width: 230px;\n  height: 230px;\n}\n\n.vue-qrcode-warp {\n  text-align: center;\n  padding-top: 20px;\n  padding-bottom: 20px;\n  min-width: 350px;\n}\n\n.vue-qrcode-warp .item {\n  display: inline-block;\n}\n",name:"Qrcode",data:function(){return{baseWidth:240,warpStyle:{width:"230px"},title:"扫一扫",images:[],opened:!1}},methods:{show:function(n){this.title=n.title,this.images=n.images,this.warpStyle.width=n.images.length*this.baseWidth+"px",console.log(this.warpStyle),this.opened=!0}}},s={authorization:a("token")};function d(n){window.jQuery.ajax({headers:s,url:n.url,type:n.type,data:n.params,dataType:"json",success:n.callback})}var l=function(n,t){return{then:function(e){void 0===e&&(e=function(){}),d({type:"post",url:n,params:t,callback:e})}}},c=function(n,t){return{then:function(e){void 0===e&&(e=function(){}),d({type:"get",url:n,params:t,callback:e})}}},m={template:'<div class="jscms-comment">  <div class="comment-input-area">    <div class="comment-top">      <div class="comment-title">参与评论</div>      <div class="comment-total">共<span class="total-number">{{total}}</span>条</div>    </div>    <div class="comment-middle">      <div class="comment-input-warp">        <textarea v-model="form.mdContent" name="content" id="commentContent" cols="30" rows="10" :placeholder="config.placeholder"></textarea>      </div>      <div class="comment-control-warp">        <div class="control-login" v-show="config.boolCommentLogin===true">          <a href="javascript:void(0);">登陆 </a>后参与评论        </div>        <div class="control-user" v-show="config.boolCommentLogin===false">          <span class="user-avatar" :style="{\'background-image\': \'url(\'+ config.currentUser.avatar +\')\'}"></span>          <span class="user-nickname">{{config.currentUser.nickname}}</span>        </div>        <div class="control-submit">          <span class="input-total">{{form.mdContent.length}}/1000</span>          <span class="btn-submit" @click="submit">            提交评论          </span>        </div>      </div>    </div>    <div class="comment-tips">      {{config.tips}}    </div>  </div>  <div class="comment-content-area">    <div class="comment-top">      <div class="comment-title">评论区</div>    </div>    <div class="comment-list">      <ul v-if="commentsList.length">        <li v-for="(item, index) in commentsList" :key="index">          <div class="comment-list-item">            <div class="item-top">              <div class="item-avatar">                <span :style="{\'background-image\': \'url(\'+ item.userId.avatar +\')\'}"></span>              </div>              <div class="item-info">                <span class="nickname">{{item.userId.nickname}}</span>                <span class="time">· 23小时前</span>              </div>              <div class="item-right">                <span class="like-icon normal"></span>                <span class="like-number">{{item.likeTotal}}</span>                <a class="btn-reply" href="">回复</a>              </div>            </div>            <div class="comment-content" v-html="item.htContent"></div>          </div>        </li>      </ul>      <div class="no-comment" v-if="commentsList.length === 0">        期待你的评论。      </div>    </div>    <div class="loading-warp" v-show="loading">      <Loading text="评论加载中..." :loading="loading"></Loading>    </div>    <div class="comment-more" v-show="hasMore">      <span class="btn-more" @click="loadMore">加载更多</button>    </div>  </div></div>',style:'.jscms-comment {\n  @mainColor: #4285f4;\n  @mainDeepColor: #326ac5;\n  @fontColor: #262626;\n  // @mainColor: #45b984;\n  // @mainDeepColor: #398d67;\n  \n  .clear() {\n    content: "";\n    display: block;\n    height: 0;\n    clear: both;\n    visibility: hidden;\n  }\n\n  width: 100%;\n\n  a {\n    text-decoration: none;\n    color: @mainColor;\n\n    &:hover {\n      color: @mainDeepColor;\n    }\n  }\n\n  .comment-title {\n    margin-left: 2px;\n    float: left;\n    padding-top: 5px;\n    padding-bottom: 5px;\n    border-bottom: 2px solid @mainColor;\n    font-size: 16px;\n    font-weight: 400;\n    color: @fontColor;\n  }\n\n  .comment-input-area {\n    width: 100%;\n\n    .comment-top {\n      width: 100%;\n      box-sizing: border-box;\n\n      &::after {\n        .clear()\n      }\n\n      .comment-total {\n        padding-top: 5px;\n        padding-bottom: 5px;\n        float: right;\n        color: #787878;\n      }\n\n    }\n\n    .comment-middle {\n      margin-top: 10px;\n      background: rgba(245, 247, 249, .8);\n      border: 1px solid #ddd;\n      border-radius: 2px;\n\n      .comment-input-warp {\n        textarea {\n          border: 0;\n          color: #333;\n          flex: 1;\n          font-size: 14px;\n          height: 130px;\n          padding: 10px;\n          resize: none;\n          width: 100%;\n\n          &:focus {\n            box-shadow: none;\n          }\n        }\n      }\n\n      .comment-control-warp {\n        height: 50px;\n        line-height: 30px;\n        padding: 10px;\n\n        .control-login {\n          float: left;\n        }\n\n        .control-user {\n          color: @mainColor;\n          float: left;\n          height: 30px;\n          margin-right: 30px;\n          padding-left: 40px;\n          position: relative;\n\n          .user-avatar {\n            background: no-repeat 50% #787878;\n            background-size: cover;\n            border-radius: 50%;\n            height: 30px;\n            left: 0;\n            position: absolute;\n            top: 0;\n            width: 30px;\n          }\n        }\n\n        .control-submit {\n          float: right;\n\n          .input-total {\n            color: #787878;\n            font-size: 14px;\n            padding-right: 10px;\n            padding-left: 10px;\n          }\n\n          .btn-submit {\n            background-color: @mainColor;\n            border-radius: 1px;\n            color: #fff;\n            cursor: pointer;\n            float: right;\n            height: 30px;\n            padding: 0 12px;\n            position: relative;\n            user-select: none;\n            transition: all 0.3s;\n\n            &:hover {\n              background-color: @mainDeepColor;\n            }\n          }\n\n        }\n      }\n    }\n\n    .comment-tips {\n      font-size: 14px;\n      color: #787878;\n      padding-top: 10px;\n    }\n  }\n\n  .comment-content-area {\n    margin-top: 20px;\n\n    .comment-top {\n      width: 100%;\n      box-sizing: border-box;\n\n      &::after {\n        .clear()\n      }\n    }\n\n    .comment-list {\n      margin-top: 20px;\n\n      ul {\n        li {\n\n          &:last-child {\n            .comment-list-item {\n              border-bottom: none;\n            }\n          }\n\n          .comment-list-item {\n            position: relative;\n            border-bottom: 1px solid #f5f5f5;\n            padding-bottom: 10px;\n            margin-bottom: 15px;\n\n\n            .item-top {\n              &::after {\n                .clear()\n              }\n\n              .item-avatar {\n                float: left;\n\n                span {\n                  background-color: #eee;\n                  background-position: 50%;\n                  background-repeat: no-repeat;\n                  background-size: cover;\n                  border-radius: 50%;\n                  display: block;\n                  height: 40px;\n                  width: 40px;\n                }\n              }\n\n              .item-info {\n                float: left;\n\n                .nickname {\n                  font-size: 14px;\n                  color: @fontColor;\n                  margin-left: 10px;\n                }\n\n                .time {\n                  font-size: 12px;\n                  color: #a7a7a7;\n                }\n              }\n\n              .item-right {\n                float: right;\n\n                .like-icon {\n                  background-size: 100%;\n                  cursor: pointer;\n                  display: inline-block;\n                  height: 24px;\n                  width: 24px;\n                  margin-right: 10px;\n                  vertical-align: text-top;\n                  background-repeat: no-repeat;\n                  position: relative;\n                  top: -4px;\n                  right: -10px;\n\n                  &.normal {\n                    background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAA+tJREFUaAXtWN1LFFEUv3dmNl1NUSKIPi0I8qGehMIkMfxICfuCDdLddT999KU/oNegf8BddtfZsrIQsx5SqCSKCjKqV7NNkkjKMDE/cp17O3d1bBjd2Z39oCFmYblzzz3nnt/vzDn3XAYh82dGwIyAGYH/PgK9vb3lwWi0Mh9EcT42Ve4ZCInnKEVRhOhWkA+Vlxadt9lsi0qdbJ7zSiAYFs8QQu8CQIsMEmM8XFZibQUSy7Ism5HLxljLNhAWT0Pk74AOgMfTGKN+pk8pbZqZW+gbGRkRtOzTXcsLAUibZkRRP4DdgjD+IWCu3ud22oDE7QQwis6OffwswnrW/rPeQB2pQDjaBMAGEuARnuEpavB47O8hdcjBA/vsGOHBVRt6CXSvqO31znNKANKmHlFyD0AUQLR/cgJt8Hqdb2VQdXV1K7t3br+IMJpYk9nktUzHnOQhcx4MR08SSu9D6hTCdBZxQqOvo/2NGtjk1HQX6FQwOUb0pXpd7zwnBCAVagkhD8C5FSI/hznhlM/V/loNpjssOhEhV5kcjr93RQVCl1pH7zzrY7Q7FK2BSA5BzhcDrF+Y45r8bvsLNZBgJNpCJAr5TwWog08W3lrtctmm1Hp651kRCISvV1NChlmTgiKdB/DNPpf9mRpEMHLjGJFWHoO8CN7QdwtnOe5ytX1Q62UyT0kgEOpJFJqALaNud1tMdsKuBiROX8HBXgqyBQDf4nc7nsrr8tgduXkIkfhz0NvGZJjD1+B5Q3rJ+soRc/zXzQKi1ElZA9CM+piBhOOdMATWjSVUuQYe8Tx/weuybwAviuKupXicvaEEeGZLCb28vkeKBypJCHpK0O9x+pOp5uQYlQr4UbWDSGSgbGkFDQHkveo1PXOorQ74J8WZ8g3ocabUXT68Zx7FYjVKmZ5nPLc4CMBroZPHWBNMZps3Ap1VVXFwOpvMsZYc6ms/RehEQgfjsJZu3ghoOU21BoeDF+qLHTBxq4B6tPST5paWUT7XVm+p1M18QOoMOByOb1r+DEdgfGKyFa4aOxhojvJ/T70kLAxHAI7ZxJEJ3Xrc42l7kgT3uthQBCKRWxWArJGhoxwOQgpBLWv/DFXEy2TZl27xyrQM8wb0Fq/hCOgtXsMR0Fu8hiLAiheuDQ0MVLrFaygCieKFYx9Apey8MnB5/OdFnGnxygRycozyv6WqUEjM6OI2Hps8qqfzysDlMScEJEl6KG+of1ztVXLn9XrbdW2REwK6PG6izL5kwM3Nm07nVZunJsALR5gRLt7yRWlstXCP5hGXWFPK9T7zEqGlJYVjufrYq9e/qW9GwIyAGQEzAmYEzAhkE4E/wI1f80wVWGMAAAAASUVORK5CYII=);\n                  }\n\n                  &.liked {\n                    background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAArZJREFUaAXtWE9rE0EUf2+TTXKqtYiioigiUihCEQRBv0CvyWa154IHj9485QP4Bcy1sSZdKl4UpGjNSS0e1PjnIh4KehEFRQvZze7zbWRhLZudWXcrI85CmMn7//vNvBc2APrRDGgGNAOagRwMYA5faVeyrKM+GfOludm72GqNpB0lDA0Jm1wmrmWd9QgHPgV3vMHrDrVaheYsNNhOpFz8GQjgPhFNhToCsL1Xb27stMvzfdcAuPWL80C4zkVPxwtkMEtuo3k9Lsuz3xUAw/ql0wD+Ohe7N6k4ll/1Gs1rSbqsssKbeGjbc+jTBhe5L60YTrxtGjCFjuOn2Yl0hZ4A2fYsjoIHouLHRSHezlt8GKcsQiir51F5yvWDh2y/X+SDCH3z4IElkZ2MvpArRIuLJ1139AiIDomScvEDE+ECs/9VZCujzw2Ar80JZr7PM/KwMCHCVqVcOofd7kehraSBEMCw3myGsSrV8jNcWXkfj8vX5rgbYJ8n/JG4PGnPzH8xS8Z57PXeJun/VCbRA9QLg3ued5mXdjwR/8JekSk+9CHCJ65P9rAx5iMeZuK+ZMBmeXX13kQDVkgASHPPoqMFvmYLWTwCn3Fb1jHul61JfoWO0UlJcsi/Q632Oc1fdQAdXF7+8e8CMH7vuSQgyp4AT63NiuM8Tyo6LlMWAKCY/RDIX5xCcd7S94j4zaxVu+lWv7RqngDRTVHzRuDUBFA2pN/alAMwbt5e70XEsGhVDgC/hkqzH4JTqonHzTszLdW80cmodgIdbLe3o+JkVqUAEJUyXZ8QoDIAuHmfVtduvZRhPW6jDADmMjP7ypwAs//JnNkzfnGKsyuzzzWFEGmNx947mUQTbQwKTNPcyNq8UTwxAAP4XzYAE+BD5BStpuM85n340Y9mQDOgGdAMaAY0A/8lAz8Bc5fA/BF5WqMAAAAASUVORK5CYII=) no-repeat 0;\n                  }\n                }\n\n                .like-number {\n                  font-size: 13px;\n                  padding-left: 5px;\n                  padding-right: 5px;\n                  margin-right: 2px;\n                  color: #787878;\n                }\n              }\n            }\n\n            .comment-content {\n              word-wrap: break-word;\n              word-break: normal;\n              position: relative;\n              margin-left: 50px;\n              top: -10px;\n              color: @fontColor;\n\n              p {\n                word-wrap: break-word;\n                word-break: normal;\n                margin: 0px;\n                padding: 0px;\n              }\n            }\n          }\n        }\n      }\n\n      .no-comment {\n        color: #787878;\n        padding: 30px;\n        text-align: center;\n      }\n    }\n\n    .comment-more {\n      padding: 10px;\n      padding-top: 0px;\n      text-align: center;\n\n      .btn-more {\n        display: inline-block;\n        border-radius: 20px;\n        width:  100px;\n        height: 30px;\n        line-height: 29px;\n        border: 1px solid @mainColor;\n        color: @mainColor;\n        font-size: 14px;\n        transition: all 0.2s;\n        cursor: pointer;\n\n        &:hover {\n          background-color: @mainColor;\n          color: #fff;\n        }\n      }\n    }\n\n    .loading-warp() {\n      min-height: 250px;\n      width: 100%;\n    }\n  }\n}\n',name:"Comment",data:function(){return{theme:{fontColor:"#262626",mainColor:"#4285f4",mainDeepColor:"#326ac5"},article:{id:window.__JSCMS_CONSTANT__.article.id,numberId:window.__JSCMS_CONSTANT__.article.numberId},form:{numberId:window.__JSCMS_CONSTANT__.article.numberId,mdContent:""},config:{currentUser:{}},params:{numberId:window.__JSCMS_CONSTANT__.article.numberId,pageSize:10,pageNumber:1},commentsList:[],loading:!0,hasMore:!1,needLogin:!0,total:0}},created:function(){i("\n      .h-loading .h-loading-circular>svg .circle {\n        stroke: "+this.theme.mainColor+" !important;\n      }\n    ")},mounted:function(){var n=this;c("http://127.0.0.1:7011/api/front/comment/config").then(function(t){console.log("res.data",t.data),n.config=t.data,n.loadList()})},methods:{loadList:function(){var n=this;this.loading=!0,c("http://127.0.0.1:7011/api/front/comment/list",this.params).then(function(t){setTimeout(function(){var e=n.commentsList.length;n.commentsList=e?n.commentsList.concat(t.data.list):t.data.list,n.total=t.data.total,n.hasMore=n.total>(e=n.commentsList.length),n.loading=!1},500)})},loadMore:function(){this.params.pageNumber++,this.loadList()},check:function(){if(this.form.mdContent.replace(/[\r\n]/g,"").replace(/\s+/g,"")){if(1e3>=this.form.mdContent.length)return!0;this.$Message({type:"error",text:"评论内容字符长度不能超过1000"})}else this.$Message({type:"error",text:"评论内容不能为空"})},submit:function(){var n=this;this.check()&&l("http://127.0.0.1:7011/api/front/comment/create",this.form).then(function(t){if(0===t.code){var e=t.data;e.userId=n.config.currentUser,n.commentsList.unshift(e),n.form.content="",n.total++}n.$Message({type:0===t.code?"success":"error",text:t.msg})})}}};return function(){function s(n){void 0===n&&(n={}),this.loadedCallbacks=[],this.loader={css:t,js:e,vue:o,style:i}}var d=s.prototype;return d._mountApi=function(){var n=this;this.comment={},this.comment.render=function(t){void 0===t&&(t={});var e=document.querySelector(t.selector);e.innerHTML="";var o=n._createDiv("",e);return n._initVue({component:m,selector:"#"+o.id,id:n._id()})},this.dialog={};var t=this._createDiv();this.dialog.qrcode=this._initVue({component:r,selector:"#"+t.id,id:t.id})},d._createDiv=function(n,t){void 0===n&&(n=""),void 0===t&&(t=document.body);var e=document.createElement("div");return e.id=n||this._id(),t.appendChild(e),e},d._id=function(){return"id_"+Math.random().toString(36).substr(2)},d._initVue=function(n){var t=n.component,e=n.selector;i(t.style,"vueStyle_"+n.id);var o=new Vue(Object.assign({el:e},t));return window.less.refresh(),o},d.init=function(i){var a=this;"function"==typeof i&&this.loadedCallbacks.push(i),function(n,i){void 0===i&&(i=function(){});var a="string"==typeof n?[n]:n,r=a.length;a.forEach(function(n){var a=n.variable,s=n.url,d=n.after||function(){},l=function(n,t){};switch(n.type){case"css":l=t;break;case"vue":l=o;break;default:l=e}l({url:s,variable:a,callback:function(){--r>0||(d(),i())}})})}(n,function(){a._mountApi(),a.loadedCallbacks.forEach(function(n){return n.call(a)})})},d.loaded=function(n){"function"==typeof n&&this.loadedCallbacks.push(n)},d.store=function(n,t){return a(n,t)},s}()});
